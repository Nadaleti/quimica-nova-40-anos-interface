<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>QuimicaNovaInterface</title>
    <base href="/">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Neovis.js -->
    <script src="https://rawgit.com/neo4j-contrib/neovis.js/master/dist/neovis.js"></script>

    <script type="text/javascript">
        let viz;
        let recordCount;
    
        function draw() {
            let config = {
                container_id: "visualization",
                server_url: "bolt://localhost:7687",
                server_user: "neo4j",
                server_password: "4321",
                labels: {
                    "Keyword": {
                        "caption": "keyword",
                        "size": "numOccurrences",
                        "community": "community"
                    }
                },
                relationships: {
                    "RELATED": {
                        //"thickness": "weight",
                        "caption": false
                    }
                },
               
                initial_cypher: document.getElementById('query').value 
            };
    
            viz = new NeoVis.default(config);
            viz.render();

            document.getElementById('loading').style.display = 'block';
            document.getElementById('empty-result').style.display = 'none';

            // Quando termina a consulta, finaliza o 'load' e verifica se houve resultado ou nÃ£o
            recordCount = -1;
            viz.registerOnEvent('completed', (e) => {
                if (recordCount < 0) {
                    recordCount = e.record_count;
                }

                if (recordCount == 0) {
                    document.getElementById('empty-result').style.display = 'block';
                }

                document.getElementById('loading').style.display = 'none';
            });
        }

        function filter() {
            viz.renderWithCypher(document.getElementById('communityAlg').value);
            viz.renderWithCypher(document.getElementById('query').value);

            document.getElementById('loading').style.display = 'block';
            document.getElementById('empty-result').style.display = 'none';

            recordCount = -1;
        }
    </script>
</head>

<body onload="draw()">
    <app-root></app-root>
</body>

</html>